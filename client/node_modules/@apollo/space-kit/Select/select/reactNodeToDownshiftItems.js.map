{"version":3,"file":"reactNodeToDownshiftItems.js","sources":["../../src/Select/select/reactNodeToDownshiftItems.ts"],"sourcesContent":["import React from \"react\";\nimport { render } from \"react-dom\";\n\ntype OptionProps = React.DetailedHTMLProps<\n  React.OptionHTMLAttributes<HTMLOptionElement>,\n  HTMLOptionElement\n>;\n\ntype OptgroupProps = React.DetailedHTMLProps<\n  React.OptgroupHTMLAttributes<HTMLOptGroupElement>,\n  HTMLOptGroupElement\n>;\n\nexport function isHTMLOptionElement(\n  element: React.ReactNode,\n): element is React.ReactElement<OptionProps, \"option\"> {\n  if (!React.isValidElement(element)) {\n    return false;\n  }\n\n  // This is a special check performed only for MDX processing in storybook\n  if (element.props.originalType) {\n    return element.props.originalType === \"option\";\n  }\n\n  if (typeof element.type === \"string\") {\n    return element.type === \"option\";\n  }\n\n  return renderHTML(element) instanceof HTMLOptionElement;\n}\n\nfunction renderHTML(element: React.ReactElement) {\n  const div = document.createElement(\"div\");\n  render(element, div);\n\n  if (div.childNodes.length !== 1) {\n    throw new Error(\"BUG: must only have one child\");\n  }\n  return div.childNodes[0];\n}\n\nexport function isHTMLOptgroupElement(\n  element: React.ReactNode,\n): element is React.ReactElement<OptgroupProps, \"optgroup\"> {\n  if (!React.isValidElement(element)) {\n    return false;\n  }\n\n  // This is a special check performed only for MDX processing in storybook\n  if (element.props.originalType) {\n    return element.props.originalType === \"optgroup\";\n  }\n\n  if (typeof element.type === \"string\") {\n    return element.type === \"optgroup\";\n  }\n\n  return renderHTML(element) instanceof HTMLOptGroupElement;\n}\n\nfunction validateOptionProps(\n  element: React.ReactElement<OptionProps, \"option\">,\n): OptionProps {\n  if (\n    Object.prototype.hasOwnProperty.call(element.props, \"value\") ||\n    typeof element.props.children === \"string\"\n  ) {\n    return element.props;\n  }\n\n  throw new TypeError(\n    \"All `option`s in a `Select` are required to have a `value` set or have `children` be a string to imply a value.\",\n  );\n}\n\n/**\n * Convert a `children` prop rendered with `<optgroup><option /></optgroup>` and\n * `<option />` elements into an array of the props of each of those `option`\n * elements.\n */\nexport function reactNodeToDownshiftItems(\n  children: React.ReactNode,\n): OptionProps[] {\n  return React.Children.toArray(children).reduce<OptionProps[]>(\n    (accumulator, child) => {\n      if (isHTMLOptionElement(child)) {\n        return accumulator.concat(validateOptionProps(child));\n      }\n\n      if (!React.isValidElement(child)) {\n        return accumulator;\n      }\n\n      return accumulator.concat(\n        React.Children.toArray(child.props.children)\n          .filter(isHTMLOptionElement)\n          .map((optgroupChild) => validateOptionProps(optgroupChild)),\n      );\n    },\n    [],\n  );\n}\n"],"names":["isHTMLOptionElement","element","React","isValidElement","props","originalType","type","renderHTML","HTMLOptionElement","div","document","createElement","render","childNodes","length","Error","isHTMLOptgroupElement","HTMLOptGroupElement","validateOptionProps","Object","prototype","hasOwnProperty","call","children","TypeError","reactNodeToDownshiftItems","Children","toArray","reduce","accumulator","child","concat","filter","map","optgroupChild"],"mappings":";;;;;;;;;;SAagBA,oBACdC;MAEI,eAACC,cAAK,CAACC,cAAN,CAAqBF,OAArB,CAAL,EAAoC;WAC3B,KAAP;;;;MAIEA,OAAO,CAACG,KAAR,CAAcC,YAAlB,EAAgC;WACvBJ,OAAO,CAACG,KAAR,CAAcC,YAAd,KAA+B,QAAtC;;;MAGE,OAAOJ,OAAO,CAACK,IAAf,KAAwB,QAA5B,EAAsC;WAC7BL,OAAO,CAACK,IAAR,KAAiB,QAAxB;;;SAGKC,UAAU,CAACN,OAAD,CAAV,YAA+BO,iBAAtC;;;AAGF,SAASD,UAAT,CAAoBN,OAApB;MACQQ,GAAG,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAZ;EACAC,eAAM,CAACX,OAAD,EAAUQ,GAAV,CAAN;;MAEIA,GAAG,CAACI,UAAJ,CAAeC,MAAf,KAA0B,CAA9B,EAAiC;UACzB,IAAIC,KAAJ,CAAU,+BAAV,CAAN;;;SAEKN,GAAG,CAACI,UAAJ,CAAe,CAAf,CAAP;;;AAGF,SAAgBG,sBACdf;MAEI,eAACC,cAAK,CAACC,cAAN,CAAqBF,OAArB,CAAL,EAAoC;WAC3B,KAAP;;;;MAIEA,OAAO,CAACG,KAAR,CAAcC,YAAlB,EAAgC;WACvBJ,OAAO,CAACG,KAAR,CAAcC,YAAd,KAA+B,UAAtC;;;MAGE,OAAOJ,OAAO,CAACK,IAAf,KAAwB,QAA5B,EAAsC;WAC7BL,OAAO,CAACK,IAAR,KAAiB,UAAxB;;;SAGKC,UAAU,CAACN,OAAD,CAAV,YAA+BgB,mBAAtC;;;AAGF,SAASC,mBAAT,CACEjB,OADF;MAIIkB,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCrB,OAAO,CAACG,KAA7C,EAAoD,OAApD,KACA,OAAOH,OAAO,CAACG,KAAR,CAAcmB,QAArB,KAAkC,QAFpC,EAGE;WACOtB,OAAO,CAACG,KAAf;;;QAGI,IAAIoB,SAAJ,CACJ,iHADI,CAAN;;;;;;;;;AAUF,SAAgBC,0BACdF;SAEOrB,cAAK,CAACwB,QAAN,CAAeC,OAAf,CAAuBJ,QAAvB,EAAiCK,MAAjC,CACL,UAACC,WAAD,EAAcC,KAAd;QACM9B,mBAAmB,CAAC8B,KAAD,CAAvB,EAAgC;aACvBD,WAAW,CAACE,MAAZ,CAAmBb,mBAAmB,CAACY,KAAD,CAAtC,CAAP;;;QAGE,eAAC5B,cAAK,CAACC,cAAN,CAAqB2B,KAArB,CAAL,EAAkC;aACzBD,WAAP;;;WAGKA,WAAW,CAACE,MAAZ,CACL7B,cAAK,CAACwB,QAAN,CAAeC,OAAf,CAAuBG,KAAK,CAAC1B,KAAN,CAAYmB,QAAnC,EACGS,MADH,CACUhC,mBADV,EAEGiC,GAFH,CAEO,UAACC,aAAD;aAAmBhB,mBAAmB,CAACgB,aAAD,CAAnB;KAF1B,CADK,CAAP;GAVG,EAgBL,EAhBK,CAAP;;;;;;;"}