{"version":3,"file":"SingletonComponent-7ca6baa8.js","sources":["node_modules/style-inject/dist/style-inject.es.js","src/shared/components/SingletonComponent.tsx"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React from \"react\";\nimport {\n  useHasSpaceKitProvider,\n  useSingletonComponent,\n} from \"../../SpaceKitProvider\";\n\n/**\n * Indicates that we have already warned the user of needing a\n * `SpaceKitProvider` once so we don't do it multiple times.\n */\nlet spaceKitProviderWarningIssued = false;\n\n/**\n * Indicates that we have already warned the user of changing `children` on\n * re-renders\n */\nlet childrenChangedWarningIssued = false;\n\n/**\n * Component used to communicate with SpaceKitProvider to ensure that instances\n * of this component rendered with the same `identity` will always result in a\n * single element in the DOM.\n *\n * If there is no SpaceKitProvider, print a warning and passthrough the\n * `children`\n *\n * This will assume that you don't actually care where the element is rendered\n * in the DOM.\n *\n * All changes to `children` will be ignored. A warning will be logged if\n * `children` changes. You should memoize `children` to avoid this warning.\n */\nexport const SingletonComponent: React.FC<{\n  children: ReturnType<React.FC>;\n  identity: string;\n}> = ({ children, identity }) => {\n  const hasSpaceKitProvider = useHasSpaceKitProvider();\n  const { show, hide } = useSingletonComponent();\n  const initialChildren = React.useRef(children);\n\n  React.useEffect(() => {\n    show({ identity, element: initialChildren.current });\n\n    return () => {\n      hide({ identity });\n    };\n  }, [initialChildren, hide, identity, show]);\n\n  if (!hasSpaceKitProvider && !spaceKitProviderWarningIssued) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      \"You must wrap your application with SpaceKitProvider to prevent repeated `<style />` tags being injected into the DOM.\",\n    );\n    spaceKitProviderWarningIssued = true;\n  }\n\n  if (children !== initialChildren.current && !childrenChangedWarningIssued) {\n    // eslint-disable-next-line no-console\n    console.error(\n      \"All changes to `children` of `SingletonComponent` will be ignored. You should memoize the input.\",\n    );\n    childrenChangedWarningIssued = true;\n  }\n\n  initialChildren.current = children;\n\n  return hasSpaceKitProvider ? null : children;\n};\n"],"names":["styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","spaceKitProviderWarningIssued","childrenChangedWarningIssued","SingletonComponent","_a","children","identity","hasSpaceKitProvider","useHasSpaceKitProvider","_b","useSingletonComponent","show","hide","initialChildren","React","useRef","useEffect","element","current","console","warn","error"],"mappings":";;;;;;;;AAAA,SAASA,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+B;MACxBA,GAAG,KAAK,KAAK,CAAlB,EAAsBA,GAAG,GAAG,EAAN;MAClBC,QAAQ,GAAGD,GAAG,CAACC,QAAnB;;MAEI,CAACF,GAAD,IAAQ,OAAOG,QAAP,KAAoB,WAAhC,EAA6C;;;;MAEzCC,IAAI,GAAGD,QAAQ,CAACC,IAAT,IAAiBD,QAAQ,CAACE,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAA5B;MACIC,KAAK,GAAGH,QAAQ,CAACI,aAAT,CAAuB,OAAvB,CAAZ;EACAD,KAAK,CAACE,IAAN,GAAa,UAAb;;MAEIN,QAAQ,KAAK,KAAjB,EAAwB;QAClBE,IAAI,CAACK,UAAT,EAAqB;MACnBL,IAAI,CAACM,YAAL,CAAkBJ,KAAlB,EAAyBF,IAAI,CAACK,UAA9B;KADF,MAEO;MACLL,IAAI,CAACO,WAAL,CAAiBL,KAAjB;;GAJJ,MAMO;IACLF,IAAI,CAACO,WAAL,CAAiBL,KAAjB;;;MAGEA,KAAK,CAACM,UAAV,EAAsB;IACpBN,KAAK,CAACM,UAAN,CAAiBC,OAAjB,GAA2Bb,GAA3B;GADF,MAEO;IACLM,KAAK,CAACK,WAAN,CAAkBR,QAAQ,CAACW,cAAT,CAAwBd,GAAxB,CAAlB;;;;;;;ACjBJ;;;;;AAIA,IAAIe,6BAA6B,GAAG,KAApC;;;;;;AAMA,IAAIC,4BAA4B,GAAG,KAAnC;;;;;;;;;;;;;;;;AAgBA,IAAaC,kBAAkB,GAG1B,UAACC,EAAD;MAAGC,QAAQ;MAAEC,QAAQ;MAClBC,mBAAmB,GAAGC,4BAAsB,EAAlD;;MACMC,KAAiBC,2BAAqB,EAAtC;MAAEC,IAAI,UAAN;MAAQC,IAAI,UAAZ;;MACAC,eAAe,GAAGC,cAAK,CAACC,MAAN,CAAaV,QAAb,CAAxB;EAEAS,cAAK,CAACE,SAAN,CAAgB;IACdL,IAAI,CAAC;MAAEL,QAAQ,UAAV;MAAYW,OAAO,EAAEJ,eAAe,CAACK;KAAtC,CAAJ;WAEO;MACLN,IAAI,CAAC;QAAEN,QAAQ;OAAX,CAAJ;KADF;GAHF,EAMG,CAACO,eAAD,EAAkBD,IAAlB,EAAwBN,QAAxB,EAAkCK,IAAlC,CANH;;MAQI,CAACJ,mBAAD,IAAwB,CAACN,6BAA7B,EAA4D;;IAE1DkB,OAAO,CAACC,IAAR,CACE,wHADF;IAGAnB,6BAA6B,GAAG,IAAhC;;;MAGEI,QAAQ,KAAKQ,eAAe,CAACK,OAA7B,IAAwC,CAAChB,4BAA7C,EAA2E;;IAEzEiB,OAAO,CAACE,KAAR,CACE,kGADF;IAGAnB,4BAA4B,GAAG,IAA/B;;;EAGFW,eAAe,CAACK,OAAhB,GAA0Bb,QAA1B;SAEOE,mBAAmB,GAAG,IAAH,GAAUF,QAApC;CAlCK;;;;;"}